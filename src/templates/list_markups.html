<!-- list_markups.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Markups</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4 text-primary">Lista de Markups</h1>

        <table class="table table-bordered shadow">
            <thead class="table-light text-center">
                <tr>
                    <th>#</th>
                    <th>Número de Parte</th>
                    <th>Descripción</th>
                    <th>Revisión</th>
                    <th>Fecha de Creación</th>
                    <th>Fecha Límite</th>
                    <th>Empleado</th>
                    <th>Estatus</th>
                    <th>Ruta</th>
                    <th>Celda</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for markup in markups %}
                <tr class="text-center">
                    <td>{{ markup[0] }}</td>
                    <td>{{ markup[1] }}</td>
                    <td class="text-start">{{ markup[2] }}</td>
                    <td>{{ markup[3] }}</td>
                    <td>{{ markup[4]|datetimeformat }}</td>
                    <td>{{ markup[5]|datetimeformat }}</td>
                    <td>{{ markup[6] }}</td>
                    <td>{{ markup[7] }}</td>
                    <td>{{ markup[8] }}</td>
                    <td>{{ markup[9] }}</td>
                    <td>
                        <button class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#editModal{{ markup[0] }}">
                            Editar
                        </button>
                    </td>
                </tr>

                <!-- Modal de edición -->
                <div class="modal fade" id="editModal{{ markup[0] }}" tabindex="-1" aria-labelledby="editLabel{{ markup[0] }}" aria-hidden="true">
                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <form action="{{ url_for('edit_markup', id=markup[0]) }}" method="POST">
                        <div class="modal-header">
                          <h5 class="modal-title" id="editLabel{{ markup[0] }}">Editar Markup #{{ markup[0] }}</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                        </div>
                        <div class="modal-body">
                          <div class="row mb-3">
                            <div class="col">
                              <label>Número de parte</label>
                              <input type="text" name="part_number" class="form-control" value="{{ markup[1] }}">
                            </div>
                            <div class="col">
                              <label>Revisión</label>
                              <input type="text" name="revision" class="form-control" value="{{ markup[3] }}">
                            </div>
                          </div>
                          <div class="mb-3">
                            <label>Descripción</label>
                            <textarea name="description" class="form-control">{{ markup[2] }}</textarea>
                          </div>
                          <div class="row mb-3">
                            <div class="col">
                              <label>Fecha de creación</label>
                              <input type="date" name="created_at" class="form-control" value="{{ markup[4]|datetimeformat }}">
                            </div>
                          </div>
                          <div class="row mb-3">
                            <div class="col">
                              <label>Responsable</label>
                              <select name="employee_id" class="form-select">
                                {% for emp in employees %}
                                <option value="{{ emp[0] }}" {% if emp[1] == markup[6] %}selected{% endif %}>{{ emp[1] }}</option>
                                {% endfor %}
                              </select>
                            </div>
                            <div class="col">
                              <label>Estatus</label>
                              <select name="status_id" class="form-select">
                                {% for status in statuses %}
                                <option value="{{ status[0] }}" {% if status[1] == markup[7] %}selected{% endif %}>{{ status[1] }}</option>
                                {% endfor %}
                              </select>
                            </div>
                            <div class="col">
                              <label>Ruta</label>
                              <select name="route_id" class="form-select">
                                {% for route in routes %}
                                <option value="{{ route[0] }}" {% if route[1] == markup[8] %}selected{% endif %}>{{ route[1] }}</option>
                                {% endfor %}
                              </select>
                            </div>
                            <div class="col">
                              <label>Celda</label>
                              <select name="workcell_id" class="form-select">
                                {% for cell in workcells %}
                                <option value="{{ cell[0] }}" {% if cell[1] == markup[9] %}selected{% endif %}>{{ cell[1] }}</option>
                                {% endfor %}
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                            <button type="submit" class="btn btn-success">Guardar cambios</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>